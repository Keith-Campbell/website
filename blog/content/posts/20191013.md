+++
title = "初デプロイ完了"
date = 2019-10-13T20:20:48+09:00
author = "a24"
categories = ["develop", "web", "test"]
description = ""
image = ""
tags = ["web"]
draft = false
+++

Next.jsのウェブサイトとhugoで作成したブログを同じドメイン上で公開するにはどうすればいいかと悩んで数日，ようやく解決した．

公開方法は以下のようになる．
まずフォルダ構成であるが，次のように配置した．

<!--more-->

```bash
website/
    ├.next/
    ├blog/ # hugoをインストールしたディレクトリ
        ├content/
            ├posts
                └[記事名].md
        ├public/ # hugoコマンドをしたときに作成される公開向けのディレクトリ

        ├static/
            ├images/ # ブログで公開する画像を保管するディレクトリ
    ├components/
    ...etc...
    ├out # npm run build ; npm run export した際に生成される公開向けディレクトリ
        ├(blog/) # out 生成後に作成予定のブログ用公開ディレクトリ
```

私は静的ホスティングサービスにNetlifyを利用しているが，Build settingsのBuild commandは`npm run deploy ; mkdir out/blog ; cp -pR blog/public/* out/blog`としている．ディレクトリ名`out`と`public`はそれぞれNext.jsでビルドし，エクスポートしたときに生成されるディレクトリとhugoでビルドしたときに生成されるエクスポートディレクトリ名であるが，初期設定から変えていなければそのままで良いはずだ．

![img](/blog/image/netlifyBuild.jpg)

こうすることで，ウェブサイトと同じドメイン上でhugoで作成したブログページを`http://example.com/blog`の形で公開することができた．

ウェブサイトは以下の本の5章以降を参考に作成している．まず，React.jsを知らないとNext.jsを使ってウェブアプリを作成するのは難しいので，結局一から読んでいる．

<iframe style="width:120px;height:240px;" marginwidth="0" marginheight="0" scrolling="no" frameborder="0" src="https://rcm-fe.amazon-adsystem.com/e/cm?ref=tf_til&t=keithcampbell-22&m=amazon&o=9&p=8&l=as1&IS1=1&detail=1&asins=4798056928&linkId=85caed3d6a79998c5fdbdf5d2e016be3&bc1=ffffff&lt1=_top&fc1=333333&lc1=0066c0&bg1=ffffff&f=ifr">
    </iframe>

JavaScriptの知識に自信がない私は定評のある『JavaScript本格入門』をまず読んでから取り組んでいる．

<iframe style="width:120px;height:240px;" marginwidth="0" marginheight="0" scrolling="no" frameborder="0" src="https://rcm-fe.amazon-adsystem.com/e/cm?ref=tf_til&t=keithcampbell-22&m=amazon&o=9&p=8&l=as1&IS1=1&detail=1&asins=477418411X&linkId=9af03dc0959a31e01f5275d1d186cbf2&bc1=ffffff&lt1=_top&fc1=333333&lc1=0066c0&bg1=ffffff&f=ifr">
    </iframe>